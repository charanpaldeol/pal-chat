<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
    <title>Pal Chat â€“ Private & Secure Messaging</title>
  
    <meta name="description" content="Pal Chat is  secure, no-account, ephemeral chat app built for private conversations. No storage. No tracking. Just the moment." />
    
    <!-- Open Graph (for social sharing) -->
    <meta property="og:title" content="Pal Chat â€“ Private & Secure Messaging" />
    <meta property="og:description" content="Talk securely without an account. Nothing stored, ever." />
    <meta property="og:url" content="https://palchat.org" />
    <meta property="og:type" content="website" />
    <!-- Optional image -->
    <!-- <meta property="og:image" content="https://palchat.org/og-image.png" /> -->
  </head>
  
<body class="bg-gray-100 text-gray-900 flex items-center justify-center min-h-screen">

  <div class="w-full max-w-md p-4 bg-white rounded-2xl shadow-lg flex flex-col h-[90vh]">
    <h1 class="text-xl font-bold text-center mb-4">Pal (à¨ªà¨²) â€“ Private Chat</h1>

    <!-- Chat Messages -->
    <div id="messages" class="flex-1 overflow-y-auto space-y-2 p-2 border rounded-md mb-4">
      <!-- Messages will appear here -->
    </div>

    <!-- Input Area -->
    <div class="flex gap-2">
      <input
        id="messageInput"
        type="text"
        placeholder="Type your message..."
        class="flex-1 px-4 py-2 border rounded-xl focus:outline-none focus:ring focus:ring-blue-300"
      />
      <button
        onclick="sendMessage()"
        class="px-4 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600"
      >
        Send
      </button>
    </div>
  </div>

  <!-- WebSocket Chat Script -->
  <script>
    const messagesDiv = document.getElementById('messages');
    const input = document.getElementById('messageInput');

    const socket = new WebSocket('wss://relay.palchat.org');

    socket.onopen = () => {
      console.log('âœ… Connected to WebSocket relay');
    };

    socket.onmessage = async (event) => {
      let messageText;

      // Handle Blob vs Text
      if (event.data instanceof Blob) {
        messageText = await event.data.text();
      } else {
        messageText = event.data;
      }

      const msg = document.createElement('div');
      msg.className = "bg-gray-200 text-gray-800 px-4 py-2 rounded-xl self-start max-w-[75%]";
      msg.textContent = `ðŸ‘¤ Stranger: ${messageText}`;
      messagesDiv.appendChild(msg);
      messagesDiv.scrollTop = messagesDiv.scrollHeight;
    };

    function sendMessage() {
      const text = input.value.trim();
      if (!text) return;

      const myMsg = document.createElement('div');
      myMsg.className = "bg-blue-100 text-blue-800 px-4 py-2 rounded-xl self-end max-w-[75%]";
      myMsg.textContent = `ðŸ«µ You: ${text}`;
      messagesDiv.appendChild(myMsg);
      messagesDiv.scrollTop = messagesDiv.scrollHeight;

      socket.send(text);
      input.value = "";
    }

    input.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') sendMessage();
    });
  </script>
</body>
</html>
